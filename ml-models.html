<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Models - Cocoa Derivatives Research Lab</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="ghana-flag"></span>
                <h1>Cocoa Derivatives Lab</h1>
                <span class="ghana-flag"></span>
            </div>
            <div class="nav-links">
                <a href="index.html"><i class="fas fa-home"></i> Home</a>
                <a href="dashboard.html"><i class="fas fa-chart-line"></i> Dashboard</a>
                <a href="calculator.html"><i class="fas fa-calculator"></i> Calculator</a>
                <a href="research.html"><i class="fas fa-book"></i> Research</a>
                <a href="data.html"><i class="fas fa-database"></i> Data</a>
                <a href="ml-models.html" class="active"><i class="fas fa-brain"></i> AI Models</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- ML Header -->
        <header class="ml-header">
            <h1><i class="fas fa-brain"></i> Machine Learning Laboratory</h1>
            <p>AI-powered predictions and analytics for cocoa derivatives markets</p>
            
            <div class="ml-status">
                <div class="status-item">
                    <span class="status-label">Model Training:</span>
                    <span class="status-value active">
                        <i class="fas fa-circle"></i> Active
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">Inference Speed:</span>
                    <span class="status-value">24 ms</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Model Accuracy:</span>
                    <span class="status-value">91.4%</span>
                </div>
            </div>
        </header>

        <!-- Model Selector -->
        <section class="model-selector-section">
            <h2><i class="fas fa-cogs"></i> Select AI Model</h2>
            
            <div class="model-cards">
                <div class="model-card active" data-model="lstm">
                    <div class="model-icon">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <h3>LSTM Neural Network</h3>
                    <p>Time series forecasting for price prediction</p>
                    <div class="model-metrics">
                        <span class="metric">Accuracy: 92%</span>
                        <span class="metric">Training Time: 45 min</span>
                    </div>
                </div>
                
                <div class="model-card" data-model="xgboost">
                    <div class="model-icon">
                        <i class="fas fa-chart-tree"></i>
                    </div>
                    <h3>XGBoost Ensemble</h3>
                    <p>Gradient boosting for volatility prediction</p>
                    <div class="model-metrics">
                        <span class="metric">Accuracy: 89%</span>
                        <span class="metric">Training Time: 15 min</span>
                    </div>
                </div>
                
                <div class="model-card" data-model="transformer">
                    <div class="model-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h3>Transformer Model</h3>
                    <p>Attention-based model for complex patterns</p>
                    <div class="model-metrics">
                        <span class="metric">Accuracy: 94%</span>
                        <span class="metric">Training Time: 2 hours</span>
                    </div>
                </div>
                
                <div class="model-card" data-model="gan">
                    <div class="model-icon">
                        <i class="fas fa-random"></i>
                    </div>
                    <h3>GAN for Scenarios</h3>
                    <p>Generate realistic market scenarios</p>
                    <div class="model-metrics">
                        <span class="metric">Realism: 88%</span>
                        <span class="metric">Training Time: 3 hours</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Model Training Interface -->
        <section class="training-section">
            <h2><i class="fas fa-graduation-cap"></i> Model Training</h2>
            
            <div class="training-interface">
                <div class="training-params">
                    <h3><i class="fas fa-sliders-h"></i> Training Parameters</h3>
                    
                    <div class="param-group">
                        <div class="param">
                            <label for="epochs">Training Epochs</label>
                            <input type="number" id="epochs" value="100" min="10" max="1000">
                            <span class="param-value">100</span>
                        </div>
                        
                        <div class="param">
                            <label for="batchSize">Batch Size</label>
                            <input type="number" id="batchSize" value="32" min="1" max="256">
                            <span class="param-value">32</span>
                        </div>
                        
                        <div class="param">
                            <label for="learningRate">Learning Rate</label>
                            <input type="number" id="learningRate" value="0.001" step="0.0001" min="0.0001" max="0.1">
                            <span class="param-value">0.001</span>
                        </div>
                        
                        <div class="param">
                            <label for="trainSplit">Train/Test Split</label>
                            <input type="range" id="trainSplit" value="80" min="50" max="95">
                            <span class="param-value">80/20</span>
                        </div>
                    </div>
                    
                    <div class="feature-selection">
                        <h4><i class="fas fa-check-square"></i> Feature Selection</h4>
                        <div class="feature-list">
                            <label class="feature-checkbox">
                                <input type="checkbox" checked> Historical Prices
                            </label>
                            <label class="feature-checkbox">
                                <input type="checkbox" checked> Technical Indicators
                            </label>
                            <label class="feature-checkbox">
                                <input type="checkbox" checked> Volatility Metrics
                            </label>
                            <label class="feature-checkbox">
                                <input type="checkbox"> Macroeconomic Data
                            </label>
                            <label class="feature-checkbox">
                                <input type="checkbox"> Weather Patterns
                            </label>
                            <label class="feature-checkbox">
                                <input type="checkbox"> Social Media Sentiment
                            </label>
                        </div>
                    </div>
                    
                    <div class="training-actions">
                        <button class="btn btn-primary" id="trainModelBtn">
                            <i class="fas fa-play"></i> Start Training
                        </button>
                        <button class="btn btn-secondary" id="resetParamsBtn">
                            <i class="fas fa-redo"></i> Reset Parameters
                        </button>
                    </div>
                </div>
                
                <div class="training-progress">
                    <h3><i class="fas fa-chart-line"></i> Training Progress</h3>
                    
                    <div class="progress-charts">
                        <div class="progress-chart">
                            <h4>Loss Curve</h4>
                            <div class="chart-container" id="lossChart"></div>
                        </div>
                        
                        <div class="progress-chart">
                            <h4>Accuracy</h4>
                            <div class="chart-container" id="accuracyChart"></div>
                        </div>
                    </div>
                    
                    <div class="training-stats">
                        <div class="stat">
                            <span class="stat-label">Current Epoch</span>
                            <span class="stat-value" id="currentEpoch">0</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Training Loss</span>
                            <span class="stat-value" id="currentLoss">0.0000</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Validation Accuracy</span>
                            <span class="stat-value" id="currentAccuracy">0.00%</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Time Remaining</span>
                            <span class="stat-value" id="timeRemaining">--:--</span>
                        </div>
                    </div>
                    
                    <div class="progress-bar-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="trainingProgress" style="width: 0%"></div>
                        </div>
                        <div class="progress-label">
                            <span>Training Progress: </span>
                            <span id="progressPercent">0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Model Predictions -->
        <section class="predictions-section">
            <h2><i class="fas fa-crystal-ball"></i> AI Predictions</h2>
            
            <div class="predictions-content">
                <div class="prediction-input">
                    <h3><i class="fas fa-edit"></i> Input Parameters</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label for="predictionDays">Forecast Horizon</label>
                            <select id="predictionDays">
                                <option value="7">7 days</option>
                                <option value="30" selected>30 days</option>
                                <option value="90">90 days</option>
                                <option value="180">180 days</option>
                                <option value="365">1 year</option>
                            </select>
                        </div>
                        
                        <div class="input-field">
                            <label for="confidenceLevel">Confidence Level</label>
                            <select id="confidenceLevel">
                                <option value="80">80%</option>
                                <option value="90">90%</option>
                                <option value="95" selected>95%</option>
                                <option value="99">99%</option>
                            </select>
                        </div>
                        
                        <div class="input-field">
                            <label for="scenarioType">Scenario Type</label>
                            <select id="scenarioType">
                                <option value="base">Base Case</option>
                                <option value="bull">Bull Market</option>
                                <option value="bear">Bear Market</option>
                                <option value="volatile">High Volatility</option>
                            </select>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" id="generatePredictionsBtn">
                        <i class="fas fa-bolt"></i> Generate Predictions
                    </button>
                    
                    <div class="model-info">
                        <h4><i class="fas fa-info-circle"></i> Model Information</h4>
                        <p>Current model: <strong>LSTM Neural Network</strong></p>
                        <p>Training data: <strong>10 years of daily prices</strong></p>
                        <p>Last updated: <strong>Today, 14:30 GMT</strong></p>
                    </div>
                </div>
                
                <div class="prediction-output">
                    <h3><i class="fas fa-chart-area"></i> Price Forecast</h3>
                    <div class="chart-container" id="forecastChart"></div>
                    
                    <div class="prediction-metrics">
                        <div class="metric-card">
                            <div class="metric-label">30-day Forecast</div>
                            <div class="metric-value">$3,925</div>
                            <div class="metric-change positive">+2.1%</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">Confidence Interval</div>
                            <div class="metric-value">$3,750 - $4,100</div>
                            <div class="metric-change">±4.5%</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-label">Probability Up</div>
                            <div class="metric-value">68%</div>
                            <div class="metric-change positive">Bullish</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Model Evaluation -->
        <section class="evaluation-section">
            <h2><i class="fas fa-chart-bar"></i> Model Evaluation</h2>
            
            <div class="evaluation-content">
                <div class="evaluation-chart">
                    <h3><i class="fas fa-chart-line"></i> Backtest Performance</h3>
                    <div class="chart-container" id="backtestChart"></div>
                </div>
                
                <div class="evaluation-metrics">
                    <h3><i class="fas fa-tachometer-alt"></i> Performance Metrics</h3>
                    
                    <div class="metrics-grid">
                        <div class="eval-metric">
                            <div class="eval-label">Mean Absolute Error</div>
                            <div class="eval-value">$42.50</div>
                            <div class="eval-bar">
                                <div class="eval-fill" style="width: 85%"></div>
                            </div>
                        </div>
                        
                        <div class="eval-metric">
                            <div class="eval-label">Root Mean Square Error</div>
                            <div class="eval-value">$58.75</div>
                            <div class="eval-bar">
                                <div class="eval-fill" style="width: 78%"></div>
                            </div>
                        </div>
                        
                        <div class="eval-metric">
                            <div class="eval-label">R² Score</div>
                            <div class="eval-value">0.914</div>
                            <div class="eval-bar">
                                <div class="eval-fill" style="width: 91.4%"></div>
                            </div>
                        </div>
                        
                        <div class="eval-metric">
                            <div class="eval-label">Sharpe Ratio</div>
                            <div class="eval-value">1.42</div>
                            <div class="eval-bar">
                                <div class="eval-fill" style="width: 71%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="model-comparison">
                        <h4><i class="fas fa-balance-scale"></i> Model Comparison</h4>
                        <div class="chart-container" id="comparisonChart"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Explainable AI -->
        <section class="explainable-section">
            <h2><i class="fas fa-eye"></i> Explainable AI</h2>
            
            <div class="explainable-content">
                <div class="feature-importance">
                    <h3><i class="fas fa-chart-pie"></i> Feature Importance</h3>
                    <div class="chart-container" id="importanceChart"></div>
                </div>
                
                <div class="shap-analysis">
                    <h3><i class="fas fa-project-diagram"></i> SHAP Analysis</h3>
                    <div class="shap-plot">
                        <div class="shap-values">
                            <div class="shap-item positive">
                                <span class="shap-feature">Historical Volatility</span>
                                <span class="shap-value">+0.42</span>
                            </div>
                            <div class="shap-item positive">
                                <span class="shap-feature">RSI Indicator</span>
                                <span class="shap-value">+0.38</span>
                            </div>
                            <div class="shap-item negative">
                                <span class="shap-feature">MACD Signal</span>
                                <span class="shap-value">-0.25</span>
                            </div>
                            <div class="shap-item positive">
                                <span class="shap-feature">Volume Trend</span>
                                <span class="shap-value">+0.18</span>
                            </div>
                            <div class="shap-item negative">
                                <span class="shap-feature">Bollinger Width</span>
                                <span class="shap-value">-0.12</span>
                            </div>
                        </div>
                        <p class="shap-explanation">
                            The model predicts higher prices when historical volatility and RSI are high, 
                            but lower prices when MACD signals are bearish.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Model Deployment -->
        <section class="deployment-section">
            <h2><i class="fas fa-rocket"></i> Model Deployment</h2>
            
            <div class="deployment-options">
                <div class="deployment-option">
                    <div class="option-icon">
                        <i class="fas fa-cloud"></i>
                    </div>
                    <h3>Cloud API</h3>
                    <p>Deploy model as REST API for real-time predictions</p>
                    <button class="btn btn-primary deploy-btn">
                        <i class="fas fa-upload"></i> Deploy to Cloud
                    </button>
                </div>
                
                <div class="deployment-option">
                    <div class="option-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <h3>Export Model</h3>
                    <p>Download trained model for offline use</p>
                    <button class="btn btn-secondary deploy-btn">
                        <i class="fas fa-download"></i> Export Model
                    </button>
                </div>
                
                <div class="deployment-option">
                    <div class="option-icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <h3>Generate Code</h3>
                    <p>Generate Python code for model implementation</p>
                    <button class="btn btn-secondary deploy-btn">
                        <i class="fas fa-code"></i> Generate Code
                    </button>
                </div>
                
                <div class="deployment-option">
                    <div class="option-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>Live Monitoring</h3>
                    <p>Monitor model performance in production</p>
                    <button class="btn btn-secondary deploy-btn">
                        <i class="fas fa-chart-line"></i> Monitor
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>AI Laboratory</h4>
                <p>Machine learning models for cocoa derivatives</p>
            </div>
            
            <div class="footer-section">
                <h4>Technical Stack</h4>
                <p>TensorFlow.js • Scikit-learn • PyTorch</p>
            </div>
            
            <div class="footer-section">
                <h4>Compute Resources</h4>
                <p>GPU: NVIDIA A100 • RAM: 32GB • Storage: 1TB</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>© 2025 Ghana Cocoa Derivatives Research Lab • AI Lab v3.0</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        class MLManager {
            constructor() {
                this.currentModel = 'lstm';
                this.isTraining = false;
                this.trainingProgress = 0;
                this.initializeCharts();
                this.setupEventListeners();
                this.initializeTFModel();
            }
            
            initializeCharts() {
                // Loss chart
                const lossTrace = {
                    x: [],
                    y: [],
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#e74c3c', width: 2},
                    name: 'Training Loss'
                };
                
                Plotly.newPlot('lossChart', [lossTrace], {
                    title: 'Loss Curve',
                    xaxis: {title: 'Epoch'},
                    yaxis: {title: 'Loss'},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Accuracy chart
                const accuracyTrace = {
                    x: [],
                    y: [],
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#27ae60', width: 2},
                    name: 'Validation Accuracy'
                };
                
                Plotly.newPlot('accuracyChart', [accuracyTrace], {
                    title: 'Accuracy',
                    xaxis: {title: 'Epoch'},
                    yaxis: {title: 'Accuracy (%)', range: [0, 100]},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Forecast chart
                const forecastTrace = {
                    x: this.generateFutureDates(30),
                    y: this.generateForecastData(30),
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#3498db', width: 3},
                    name: 'Forecast',
                    fill: 'tonexty'
                };
                
                Plotly.newPlot('forecastChart', [forecastTrace], {
                    title: '30-Day Price Forecast',
                    xaxis: {title: 'Date'},
                    yaxis: {title: 'Price ($/ton)'},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Backtest chart
                const backtestTrace = {
                    x: this.generateDates(100),
                    y: this.generateBacktestData(100),
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#9b59b6', width: 2},
                    name: 'Predicted vs Actual'
                };
                
                Plotly.newPlot('backtestChart', [backtestTrace], {
                    title: 'Backtest Performance',
                    xaxis: {title: 'Date'},
                    yaxis: {title: 'Price ($/ton)'},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Comparison chart
                const comparisonTrace = {
                    x: ['LSTM', 'XGBoost', 'Transformer', 'Random Forest', 'ARIMA'],
                    y: [92, 89, 94, 85, 78],
                    type: 'bar',
                    marker: {
                        color: ['#3498db', '#2ecc71', '#9b59b6', '#f39c12', '#e74c3c']
                    }
                };
                
                Plotly.newPlot('comparisonChart', [comparisonTrace], {
                    title: 'Model Comparison (Accuracy %)',
                    xaxis: {title: 'Model'},
                    yaxis: {title: 'Accuracy (%)', range: [0, 100]},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Importance chart
                const importanceTrace = {
                    values: [35, 25, 15, 10, 8, 7],
                    labels: ['Historical Vol', 'RSI', 'MACD', 'Volume', 'Weather', 'Sentiment'],
                    type: 'pie',
                    hole: 0.4,
                    marker: {
                        colors: ['#3498db', '#2ecc71', '#9b59b6', '#f39c12', '#e74c3c', '#1abc9c']
                    }
                };
                
                Plotly.newPlot('importanceChart', [importanceTrace], {
                    title: 'Feature Importance',
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
            }
            
            generateDates(days) {
                const dates = [];
                const today = new Date();
                
                for (let i = days - 1; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - i);
                    dates.push(date.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}));
                }
                
                return dates;
            }
            
            generateFutureDates(days) {
                const dates = [];
                const today = new Date();
                
                for (let i = 1; i <= days; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() + i);
                    dates.push(date.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}));
                }
                
                return dates;
            }
            
            generateForecastData(days) {
                const prices = [];
                let price = 3842;
                
                for (let i = 0; i < days; i++) {
                    price += (Math.random() - 0.3) * 20;
                    prices.push(price);
                }
                
                return prices;
            }
            
            generateBacktestData(days) {
                const data = [];
                let actual = 3800;
                let predicted = 3820;
                
                for (let i = 0; i < days; i++) {
                    data.push({
                        actual: actual + (Math.random() - 0.5) * 50,
                        predicted: predicted + (Math.random() - 0.5) * 40
                    });
                    actual += (Math.random() - 0.5) * 30;
                    predicted += (Math.random() - 0.5) * 25;
                }
                
                return data;
            }
            
            async initializeTFModel() {
                // Initialize a simple TensorFlow model for demonstration
                this.tfModel = tf.sequential({
                    layers: [
                        tf.layers.dense({inputShape: [10], units: 32, activation: 'relu'}),
                        tf.layers.dense({units: 16, activation: 'relu'}),
                        tf.layers.dense({units: 1})
                    ]
                });
                
                this.tfModel.compile({
                    optimizer: 'adam',
                    loss: 'meanSquaredError'
                });
            }
            
            setupEventListeners() {
                // Model selection
                document.querySelectorAll('.model-card').forEach(card => {
                    card.addEventListener('click', () => {
                        document.querySelectorAll('.model-card').forEach(c => c.classList.remove('active'));
                        card.classList.add('active');
                        this.currentModel = card.dataset.model;
                        this.updateModelInfo();
                    });
                });
                
                // Training parameters
                const params = ['epochs', 'batchSize', 'learningRate', 'trainSplit'];
                params.forEach(param => {
                    const input = document.getElementById(param);
                    const valueSpan = input.parentElement.querySelector('.param-value');
                    
                    input.addEventListener('input', () => {
                        if (param === 'trainSplit') {
                            const testSplit = 100 - parseInt(input.value);
                            valueSpan.textContent = `${input.value}/${testSplit}`;
                        } else {
                            valueSpan.textContent = input.value;
                        }
                    });
                });
                
                // Training button
                document.getElementById('trainModelBtn').addEventListener('click', () => {
                    this.startTraining();
                });
                
                // Reset button
                document.getElementById('resetParamsBtn').addEventListener('click', () => {
                    this.resetParameters();
                });
                
                // Generate predictions
                document.getElementById('generatePredictionsBtn').addEventListener('click', () => {
                    this.generatePredictions();
                });
                
                // Deployment buttons
                document.querySelectorAll('.deploy-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = e.target.closest('.deployment-option').querySelector('h3').textContent;
                        this.handleDeployment(action);
                    });
                });
            }
            
            updateModelInfo() {
                const modelInfo = {
                    lstm: {
                        name: 'LSTM Neural Network',
                        data: '10 years of daily prices',
                        features: 'Historical prices, volatility, technical indicators'
                    },
                    xgboost: {
                        name: 'XGBoost Ensemble',
                        data: '8 years of daily prices',
                        features: 'Price features, volume, market indicators'
                    },
                    transformer: {
                        name: 'Transformer Model',
                        data: '12 years of high-frequency data',
                        features: 'Sequential patterns, attention mechanisms'
                    },
                    gan: {
                        name: 'Generative Adversarial Network',
                        data: 'Synthetic + historical data',
                        features: 'Market scenario generation'
                    }
                };
                
                const info = modelInfo[this.currentModel];
                const infoDiv = document.querySelector('.model-info');
                infoDiv.innerHTML = `
                    <h4><i class="fas fa-info-circle"></i> Model Information</h4>
                    <p>Current model: <strong>${info.name}</strong></p>
                    <p>Training data: <strong>${info.data}</strong></p>
                    <p>Features: <strong>${info.features}</strong></p>
                    <p>Last updated: <strong>Today, 14:30 GMT</strong></p>
                `;
            }
            
            async startTraining() {
                if (this.isTraining) {
                    alert('Training is already in progress!');
                    return;
                }
                
                this.isTraining = true;
                this.trainingProgress = 0;
                
                const epochs = parseInt(document.getElementById('epochs').value);
                const batchSize = parseInt(document.getElementById('batchSize').value);
                
                // Disable buttons during training
                document.getElementById('trainModelBtn').disabled = true;
                document.getElementById('trainModelBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Training...';
                
                // Reset progress
                this.updateTrainingProgress(0, 0, 1.0, 0);
                
                // Simulate training progress
                const interval = setInterval(() => {
                    if (this.trainingProgress >= 100) {
                        clearInterval(interval);
                        this.trainingComplete();
                        return;
                    }
                    
                    this.trainingProgress += 100 / (epochs * 10); // Simulate 10 updates per epoch
                    const currentEpoch = Math.floor(this.trainingProgress / (100 / epochs));
                    const loss = Math.max(0.01, 1.0 - (this.trainingProgress / 100) * 0.95);
                    const accuracy = Math.min(100, (this.trainingProgress / 100) * 95);
                    
                    this.updateTrainingProgress(currentEpoch, loss, accuracy, this.trainingProgress);
                    this.updateCharts(currentEpoch, loss, accuracy);
                    
                }, 100); // Update every 100ms
            }
            
            updateTrainingProgress(epoch, loss, accuracy, progress) {
                document.getElementById('currentEpoch').textContent = epoch;
                document.getElementById('currentLoss').textContent = loss.toFixed(4);
                document.getElementById('currentAccuracy').textContent = accuracy.toFixed(2) + '%';
                document.getElementById('trainingProgress').style.width = progress + '%';
                document.getElementById('progressPercent').textContent = progress.toFixed(1) + '%';
                
                // Update time remaining
                if (progress > 0 && progress < 100) {
                    const elapsedSeconds = (progress / 100) * 300; // Assume 5 minutes total
                    const remainingSeconds = 300 - elapsedSeconds;
                    const minutes = Math.floor(remainingSeconds / 60);
                    const seconds = Math.floor(remainingSeconds % 60);
                    document.getElementById('timeRemaining').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }
            
            updateCharts(epoch, loss, accuracy) {
                // Update loss chart
                Plotly.extendTraces('lossChart', {
                    x: [[epoch]],
                    y: [[loss]]
                }, [0]);
                
                // Update accuracy chart
                Plotly.extendTraces('accuracyChart', {
                    x: [[epoch]],
                    y: [[accuracy]]
                }, [0]);
            }
            
            trainingComplete() {
                this.isTraining = false;
                
                // Re-enable button
                document.getElementById('trainModelBtn').disabled = false;
                document.getElementById('trainModelBtn').innerHTML = '<i class="fas fa-play"></i> Start Training';
                
                // Show completion message
                alert('Model training completed successfully!\n\nFinal accuracy: 91.4%\nTraining time: 2 minutes 45 seconds');
                
                // Update final values
                document.getElementById('timeRemaining').textContent = '00:00';
                document.getElementById('progressPercent').textContent = '100%';
                document.getElementById('trainingProgress').style.width = '100%';
            }
            
            resetParameters() {
                document.getElementById('epochs').value = 100;
                document.getElementById('batchSize').value = 32;
                document.getElementById('learningRate').value = 0.001;
                document.getElementById('trainSplit').value = 80;
                
                // Update displays
                document.querySelectorAll('.param-value').forEach(span => {
                    const input = span.parentElement.querySelector('input');
                    if (input.id === 'trainSplit') {
                        span.textContent = '80/20';
                    } else {
                        span.textContent = input.value;
                    }
                });
                
                // Reset checkboxes
                document.querySelectorAll('.feature-checkbox input').forEach((checkbox, index) => {
                    checkbox.checked = index < 3; // First 3 checked by default
                });
            }
            
            generatePredictions() {
                const days = parseInt(document.getElementById('predictionDays').value);
                const confidence = parseInt(document.getElementById('confidenceLevel').value);
                const scenario = document.getElementById('scenarioType').value;
                
                // Generate new forecast based on parameters
                const dates = this.generateFutureDates(days);
                let baseForecast;
                
                switch(scenario) {
                    case 'bull':
                        baseForecast = this.generateBullishForecast(days);
                        break;
                    case 'bear':
                        baseForecast = this.generateBearishForecast(days);
                        break;
                    case 'volatile':
                        baseForecast = this.generateVolatileForecast(days);
                        break;
                    default:
                        baseForecast = this.generateForecastData(days);
                }
                
                // Add confidence intervals
                const lower = baseForecast.map(p => p * (1 - (100 - confidence) / 200));
                const upper = baseForecast.map(p => p * (1 + (100 - confidence) / 200));
                
                // Update forecast chart
                const forecastTrace = {
                    x: dates,
                    y: baseForecast,
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#3498db', width: 3},
                    name: 'Forecast'
                };
                
                const lowerTrace = {
                    x: dates,
                    y: lower,
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: 'rgba(52, 152, 219, 0.3)', width: 1},
                    name: 'Lower Bound',
                    showlegend: false
                };
                
                const upperTrace = {
                    x: dates,
                    y: upper,
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: 'rgba(52, 152, 219, 0.3)', width: 1},
                    fill: 'tonexty',
                    fillcolor: 'rgba(52, 152, 219, 0.1)',
                    name: 'Upper Bound',
                    showlegend: false
                };
                
                Plotly.newPlot('forecastChart', [lowerTrace, upperTrace, forecastTrace], {
                    title: `${days}-Day Price Forecast (${confidence}% CI)`,
                    xaxis: {title: 'Date'},
                    yaxis: {title: 'Price ($/ton)'},
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: {color: '#ffffff'}
                });
                
                // Update prediction metrics
                const finalPrice = baseForecast[baseForecast.length - 1];
                const changePercent = ((finalPrice - 3842) / 3842 * 100).toFixed(1);
                const range = (upper[upper.length - 1] - lower[lower.length - 1]).toFixed(0);
                const probability = confidence > 90 ? 75 : confidence > 80 ? 68 : 55;
                
                document.querySelectorAll('.prediction-metrics .metric-value')[0].textContent = `$${finalPrice.toFixed(0)}`;
                document.querySelectorAll('.prediction-metrics .metric-change')[0].textContent = 
                    `${changePercent > 0 ? '+' : ''}${changePercent}%`;
                document.querySelectorAll('.prediction-metrics .metric-change')[0].className = 
                    `metric-change ${changePercent > 0 ? 'positive' : 'negative'}`;
                
                document.querySelectorAll('.prediction-metrics .metric-value')[1].textContent = 
                    `$${lower[lower.length - 1].toFixed(0)} - $${upper[upper.length - 1].toFixed(0)}`;
                document.querySelectorAll('.prediction-metrics .metric-value')[2].textContent = `${probability}%`;
                
                alert(`Predictions generated for ${days} days with ${confidence}% confidence level.\nScenario: ${scenario}`);
            }
            
            generateBullishForecast(days) {
                const prices = [];
                let price = 3842;
                
                for (let i = 0; i < days; i++) {
                    price += (Math.random() * 0.6 + 0.2) * 20; // Mostly positive
                    prices.push(price);
                }
                
                return prices;
            }
            
            generateBearishForecast(days) {
                const prices = [];
                let price = 3842;
                
                for (let i = 0; i < days; i++) {
                    price += (Math.random() * 0.6 - 0.8) * 20; // Mostly negative
                    prices.push(price);
                }
                
                return prices;
            }
            
            generateVolatileForecast(days) {
                const prices = [];
                let price = 3842;
                
                for (let i = 0; i < days; i++) {
                    price += (Math.random() - 0.5) * 60; // High volatility
                    prices.push(price);
                }
                
                return prices;
            }
            
            handleDeployment(action) {
                alert(`${action} deployment initiated.\n\nIn a real application, this would deploy the model to the selected environment.`);
                
                // Simulate deployment progress
                if (action === 'Cloud API') {
                    setTimeout(() => {
                        alert('Model deployed successfully to cloud API!\n\nEndpoint: https://api.cocoa-lab.gh/v1/predict\nAPI Key generated and sent to your email.');
                    }, 1500);
                }
            }
        }
        
        // Initialize ML manager when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new MLManager();
        });
    </script>
    
    <style>
        /* ML-specific styles */
        .ml-header {
            margin-bottom: 2rem;
            padding: 2rem;
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ml-status {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        
        .ml-status .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .ml-status .status-label {
            color: #94a3b8;
        }
        
        .ml-status .status-value {
            font-weight: 600;
            color: #cbd5e1;
        }
        
        .ml-status .status-value.active {
            color: #27ae60;
        }
        
        .ml-status .status-value.active i {
            color: #27ae60;
            font-size: 0.75rem;
        }
        
        /* Model Selector */
        .model-selector-section {
            margin-bottom: 3rem;
        }
        
        .model-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .model-card {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .model-card:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .model-card.active {
            border-color: var(--primary);
            background: rgba(0, 107, 63, 0.2);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .model-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), #00704a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }
        
        .model-metrics {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            font-size: 0.875rem;
            color: #94a3b8;
        }
        
        /* Training Section */
        .training-section {
            margin-bottom: 3rem;
        }
        
        .training-interface {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        
        .training-params, .training-progress {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .param-group {
            margin: 1.5rem 0;
        }
        
        .param {
            margin-bottom: 1.5rem;
        }
        
        .param label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #cbd5e1;
        }
        
        .param input {
            width: 100%;
            padding: 0.75rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: white;
        }
        
        .param-value {
            display: block;
            text-align: center;
            color: var(--secondary);
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        .feature-selection {
            margin: 1.5rem 0;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .feature-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #cbd5e1;
            font-size: 0.875rem;
        }
        
        .training-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .training-actions .btn {
            flex: 1;
        }
        
        .progress-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .progress-chart {
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-chart h4 {
            margin-bottom: 1rem;
            font-size: 1rem;
            color: #cbd5e1;
        }
        
        .progress-chart .chart-container {
            height: 150px;
        }
        
        .training-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .training-stats .stat {
            text-align: center;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-label {
            display: block;
            font-size: 0.875rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            display: block;
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--secondary);
        }
        
        .progress-bar-container {
            margin-top: 1.5rem;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            color: #cbd5e1;
            font-size: 0.875rem;
        }
        
        /* Predictions Section */
        .predictions-section {
            margin-bottom: 3rem;
        }
        
        .predictions-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        
        .prediction-input, .prediction-output {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            margin: 1.5rem 0;
        }
        
        .input-field {
            margin-bottom: 1.5rem;
        }
        
        .input-field label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #cbd5e1;
        }
        
        .input-field select {
            width: 100%;
            padding: 0.75rem;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: white;
        }
        
        .model-info {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .model-info p {
            margin: 0.5rem 0;
            font-size: 0.875rem;
            color: #cbd5e1;
        }
        
        .prediction-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .metric-card {
            text-align: center;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 0.5rem 0;
        }
        
        .metric-change {
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .metric-change.positive {
            color: #27ae60;
        }
        
        .metric-change.negative {
            color: #e74c3c;
        }
        
        /* Evaluation Section */
        .evaluation-section {
            margin-bottom: 3rem;
        }
        
        .evaluation-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        
        .evaluation-chart, .evaluation-metrics {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metrics-grid {
            margin: 1.5rem 0;
        }
        
        .eval-metric {
            margin-bottom: 1.5rem;
        }
        
        .eval-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #cbd5e1;
        }
        
        .eval-value {
            float: right;
            font-weight: 800;
            color: var(--secondary);
        }
        
        .eval-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
            clear: both;
        }
        
        .eval-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 4px;
        }
        
        .model-comparison {
            margin-top: 1.5rem;
        }
        
        .model-comparison .chart-container {
            height: 250px;
        }
        
        /* Explainable AI */
        .explainable-section {
            margin-bottom: 3rem;
        }
        
        .explainable-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        
        .feature-importance, .shap-analysis {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-importance .chart-container {
            height: 300px;
        }
        
        .shap-values {
            margin: 1.5rem 0;
        }
        
        .shap-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .shap-item.positive {
            border-left: 4px solid #27ae60;
        }
        
        .shap-item.negative {
            border-left: 4px solid #e74c3c;
        }
        
        .shap-feature {
            font-weight: 600;
            color: #cbd5e1;
        }
        
        .shap-value {
            font-weight: 800;
            font-size: 1.1rem;
        }
        
        .shap-item.positive .shap-value {
            color: #27ae60;
        }
        
        .shap-item.negative .shap-value {
            color: #e74c3c;
        }
        
        .shap-explanation {
            color: #cbd5e1;
            line-height: 1.6;
            margin-top: 1rem;
            font-size: 0.875rem;
        }
        
        /* Deployment Section */
        .deployment-section {
            margin-bottom: 3rem;
        }
        
        .deployment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .deployment-option {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .option-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }
        
        .deployment-option .btn {
            width: 100%;
            margin-top: 1rem;
        }
        
        @media (max-width: 1024px) {
            .training-interface {
                grid-template-columns: 1fr;
            }
            
            .predictions-content {
                grid-template-columns: 1fr;
            }
            
            .evaluation-content {
                grid-template-columns: 1fr;
            }
            
            .explainable-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .model-cards {
                grid-template-columns: 1fr;
            }
            
            .progress-charts {
                grid-template-columns: 1fr;
            }
            
            .training-stats {
                grid-template-columns: 1fr;
            }
            
            .prediction-metrics {
                grid-template-columns: 1fr;
            }
            
            .feature-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>
